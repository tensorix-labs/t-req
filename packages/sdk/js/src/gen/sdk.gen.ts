// This file is auto-generated by @hey-api/openapi-ts

import type { Client, Options as Options2, TDataShape } from './client';
import { client } from './client.gen';
import type { DeleteScriptByRunIdData, DeleteScriptByRunIdErrors, DeleteScriptByRunIdResponses, DeleteSessionByIdData, DeleteSessionByIdErrors, DeleteSessionByIdResponses, DeleteTestByRunIdData, DeleteTestByRunIdErrors, DeleteTestByRunIdResponses, DeleteWorkspaceFileData, DeleteWorkspaceFileErrors, DeleteWorkspaceFileResponses, GetCapabilitiesData, GetCapabilitiesResponses, GetConfigData, GetConfigResponses, GetEventData, GetEventResponses, GetFlowsByFlowIdExecutionsByReqExecIdData, GetFlowsByFlowIdExecutionsByReqExecIdErrors, GetFlowsByFlowIdExecutionsByReqExecIdResponses, GetHealthData, GetHealthResponses, GetPluginsData, GetPluginsResponses, GetScriptRunnersData, GetScriptRunnersResponses, GetSessionByIdData, GetSessionByIdErrors, GetSessionByIdResponses, GetTestFrameworksData, GetTestFrameworksResponses, GetWorkspaceFileData, GetWorkspaceFileErrors, GetWorkspaceFileResponses, GetWorkspaceFilesData, GetWorkspaceFilesResponses, GetWorkspaceRequestsData, GetWorkspaceRequestsErrors, GetWorkspaceRequestsResponses, PostExecuteData, PostExecuteErrors, PostExecuteResponses, PostExecuteSseData, PostExecuteSseErrors, PostExecuteSseResponses, PostFlowsByFlowIdFinishData, PostFlowsByFlowIdFinishErrors, PostFlowsByFlowIdFinishResponses, PostFlowsData, PostFlowsErrors, PostFlowsResponses, PostParseData, PostParseErrors, PostParseResponses, PostScriptData, PostScriptErrors, PostScriptResponses, PostSessionData, PostSessionResponses, PostTestData, PostTestErrors, PostTestResponses, PostWorkspaceFileData, PostWorkspaceFileErrors, PostWorkspaceFileResponses, PutSessionByIdVariablesData, PutSessionByIdVariablesErrors, PutSessionByIdVariablesResponses, PutWorkspaceFileData, PutWorkspaceFileErrors, PutWorkspaceFileResponses } from './types.gen';

export type Options<TData extends TDataShape = TDataShape, ThrowOnError extends boolean = boolean> = Options2<TData, ThrowOnError> & {
    /**
     * You can provide a client instance returned by `createClient()` instead of
     * individual options. This might be also useful if you want to implement a
     * custom client.
     */
    client?: Client;
    /**
     * You can pass arbitrary values through the `meta` object. This can be
     * used to access values that aren't defined as part of the SDK function.
     */
    meta?: Record<string, unknown>;
};

class HeyApiClient {
    protected client: Client;
    
    constructor(args?: {
        client?: Client;
    }) {
        this.client = args?.client ?? client;
    }
}

class HeyApiRegistry<T> {
    private readonly defaultKey = 'default';
    
    private readonly instances: Map<string, T> = new Map();
    
    get(key?: string): T {
        const instance = this.instances.get(key ?? this.defaultKey);
        if (!instance) {
            throw new Error(`No SDK client found. Create one with "new TreqClient()" to fix this error.`);
        }
        return instance;
    }
    
    set(value: T, key?: string): void {
        this.instances.set(key ?? this.defaultKey, value);
    }
}

export class TreqClient extends HeyApiClient {
    public static readonly __registry = new HeyApiRegistry<TreqClient>();
    
    constructor(args?: {
        client?: Client;
        key?: string;
    }) {
        super(args);
        TreqClient.__registry.set(this, args?.key);
    }
    
    /**
     * Health check
     *
     * Check if the server is running and healthy
     */
    public getHealth<ThrowOnError extends boolean = false>(options?: Options<GetHealthData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetHealthResponses, unknown, ThrowOnError>({ url: '/health', ...options });
    }
    
    /**
     * Get server capabilities
     *
     * Returns the protocol version and supported features
     */
    public getCapabilities<ThrowOnError extends boolean = false>(options?: Options<GetCapabilitiesData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetCapabilitiesResponses, unknown, ThrowOnError>({ url: '/capabilities', ...options });
    }
    
    /**
     * Get resolved configuration
     *
     * Returns the resolved project configuration including active profile, layers applied, and cookie settings
     */
    public getConfig<ThrowOnError extends boolean = false>(options?: Options<GetConfigData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetConfigResponses, unknown, ThrowOnError>({ url: '/config', ...options });
    }
    
    /**
     * Parse .http file content
     *
     * Parse HTTP request content and return structured request information with diagnostics
     */
    public postParse<ThrowOnError extends boolean = false>(options?: Options<PostParseData, ThrowOnError>) {
        return (options?.client ?? this.client).post<PostParseResponses, PostParseErrors, ThrowOnError>({
            url: '/parse',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Execute HTTP request
     *
     * Execute an HTTP request from .http file content or file path
     */
    public postExecute<ThrowOnError extends boolean = false>(options?: Options<PostExecuteData, ThrowOnError>) {
        return (options?.client ?? this.client).post<PostExecuteResponses, PostExecuteErrors, ThrowOnError>({
            url: '/execute',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Execute SSE streaming request
     *
     * Execute an SSE (Server-Sent Events) request and stream events. Request must have @sse directive or Accept: text/event-stream header.
     */
    public postExecuteSse<ThrowOnError extends boolean = false>(options?: Options<PostExecuteSseData, ThrowOnError>) {
        return (options?.client ?? this.client).sse.post<PostExecuteSseResponses, PostExecuteSseErrors, ThrowOnError>({
            url: '/execute/sse',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Create a new session
     *
     * Create a new session with optional initial variables
     */
    public postSession<ThrowOnError extends boolean = false>(options?: Options<PostSessionData, ThrowOnError>) {
        return (options?.client ?? this.client).post<PostSessionResponses, unknown, ThrowOnError>({
            url: '/session',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Delete a session
     *
     * Delete a session and its associated data
     */
    public deleteSessionById<ThrowOnError extends boolean = false>(options: Options<DeleteSessionByIdData, ThrowOnError>) {
        return (options.client ?? this.client).delete<DeleteSessionByIdResponses, DeleteSessionByIdErrors, ThrowOnError>({ url: '/session/{id}', ...options });
    }
    
    /**
     * Get session state
     *
     * Retrieve the current state of a session
     */
    public getSessionById<ThrowOnError extends boolean = false>(options: Options<GetSessionByIdData, ThrowOnError>) {
        return (options.client ?? this.client).get<GetSessionByIdResponses, GetSessionByIdErrors, ThrowOnError>({ url: '/session/{id}', ...options });
    }
    
    /**
     * Update session variables
     *
     * Update session variables using merge or replace mode
     */
    public putSessionByIdVariables<ThrowOnError extends boolean = false>(options: Options<PutSessionByIdVariablesData, ThrowOnError>) {
        return (options.client ?? this.client).put<PutSessionByIdVariablesResponses, PutSessionByIdVariablesErrors, ThrowOnError>({
            url: '/session/{id}/variables',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options.headers
            }
        });
    }
    
    /**
     * Create a new flow
     *
     * Create a new flow to group related request executions for Observer Mode
     */
    public postFlows<ThrowOnError extends boolean = false>(options?: Options<PostFlowsData, ThrowOnError>) {
        return (options?.client ?? this.client).post<PostFlowsResponses, PostFlowsErrors, ThrowOnError>({
            url: '/flows',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Mark flow as complete
     *
     * Mark a flow as complete and get summary statistics
     */
    public postFlowsByFlowIdFinish<ThrowOnError extends boolean = false>(options: Options<PostFlowsByFlowIdFinishData, ThrowOnError>) {
        return (options.client ?? this.client).post<PostFlowsByFlowIdFinishResponses, PostFlowsByFlowIdFinishErrors, ThrowOnError>({ url: '/flows/{flowId}/finish', ...options });
    }
    
    /**
     * Get execution details
     *
     * Retrieve full request/response details for a specific execution
     */
    public getFlowsByFlowIdExecutionsByReqExecId<ThrowOnError extends boolean = false>(options: Options<GetFlowsByFlowIdExecutionsByReqExecIdData, ThrowOnError>) {
        return (options.client ?? this.client).get<GetFlowsByFlowIdExecutionsByReqExecIdResponses, GetFlowsByFlowIdExecutionsByReqExecIdErrors, ThrowOnError>({ url: '/flows/{flowId}/executions/{reqExecId}', ...options });
    }
    
    /**
     * List .http files
     *
     * List all .http files in the workspace
     */
    public getWorkspaceFiles<ThrowOnError extends boolean = false>(options?: Options<GetWorkspaceFilesData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetWorkspaceFilesResponses, unknown, ThrowOnError>({ url: '/workspace/files', ...options });
    }
    
    /**
     * List requests in file
     *
     * List all requests in a specific .http file
     */
    public getWorkspaceRequests<ThrowOnError extends boolean = false>(options: Options<GetWorkspaceRequestsData, ThrowOnError>) {
        return (options.client ?? this.client).get<GetWorkspaceRequestsResponses, GetWorkspaceRequestsErrors, ThrowOnError>({ url: '/workspace/requests', ...options });
    }
    
    /**
     * Delete file
     *
     * Delete an .http file from the workspace
     */
    public deleteWorkspaceFile<ThrowOnError extends boolean = false>(options: Options<DeleteWorkspaceFileData, ThrowOnError>) {
        return (options.client ?? this.client).delete<DeleteWorkspaceFileResponses, DeleteWorkspaceFileErrors, ThrowOnError>({ url: '/workspace/file', ...options });
    }
    
    /**
     * Get file content
     *
     * Get raw content of an .http file
     */
    public getWorkspaceFile<ThrowOnError extends boolean = false>(options: Options<GetWorkspaceFileData, ThrowOnError>) {
        return (options.client ?? this.client).get<GetWorkspaceFileResponses, GetWorkspaceFileErrors, ThrowOnError>({ url: '/workspace/file', ...options });
    }
    
    /**
     * Create file
     *
     * Create a new .http file
     */
    public postWorkspaceFile<ThrowOnError extends boolean = false>(options?: Options<PostWorkspaceFileData, ThrowOnError>) {
        return (options?.client ?? this.client).post<PostWorkspaceFileResponses, PostWorkspaceFileErrors, ThrowOnError>({
            url: '/workspace/file',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Update file
     *
     * Update content of an existing .http file
     */
    public putWorkspaceFile<ThrowOnError extends boolean = false>(options?: Options<PutWorkspaceFileData, ThrowOnError>) {
        return (options?.client ?? this.client).put<PutWorkspaceFileResponses, PutWorkspaceFileErrors, ThrowOnError>({
            url: '/workspace/file',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Run a script
     *
     * Execute a JavaScript, TypeScript, or Python script with server-side process spawning
     */
    public postScript<ThrowOnError extends boolean = false>(options?: Options<PostScriptData, ThrowOnError>) {
        return (options?.client ?? this.client).post<PostScriptResponses, PostScriptErrors, ThrowOnError>({
            url: '/script',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Cancel a running script
     *
     * Stop a running script by its run ID
     */
    public deleteScriptByRunId<ThrowOnError extends boolean = false>(options: Options<DeleteScriptByRunIdData, ThrowOnError>) {
        return (options.client ?? this.client).delete<DeleteScriptByRunIdResponses, DeleteScriptByRunIdErrors, ThrowOnError>({ url: '/script/{runId}', ...options });
    }
    
    /**
     * Get available script runners
     *
     * List available runners and auto-detect the best one for a file
     */
    public getScriptRunners<ThrowOnError extends boolean = false>(options?: Options<GetScriptRunnersData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetScriptRunnersResponses, unknown, ThrowOnError>({ url: '/script/runners', ...options });
    }
    
    /**
     * Run tests
     *
     * Execute tests using a detected or specified test framework
     */
    public postTest<ThrowOnError extends boolean = false>(options?: Options<PostTestData, ThrowOnError>) {
        return (options?.client ?? this.client).post<PostTestResponses, PostTestErrors, ThrowOnError>({
            url: '/test',
            ...options,
            headers: {
                'Content-Type': 'application/json',
                ...options?.headers
            }
        });
    }
    
    /**
     * Cancel a running test
     *
     * Stop a running test by its run ID
     */
    public deleteTestByRunId<ThrowOnError extends boolean = false>(options: Options<DeleteTestByRunIdData, ThrowOnError>) {
        return (options.client ?? this.client).delete<DeleteTestByRunIdResponses, DeleteTestByRunIdErrors, ThrowOnError>({ url: '/test/{runId}', ...options });
    }
    
    /**
     * Get available test frameworks
     *
     * List available test frameworks and auto-detect the best one
     */
    public getTestFrameworks<ThrowOnError extends boolean = false>(options?: Options<GetTestFrameworksData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetTestFrameworksResponses, unknown, ThrowOnError>({ url: '/test/frameworks', ...options });
    }
    
    /**
     * List loaded plugins
     *
     * Returns information about all loaded plugins including their capabilities and permissions
     */
    public getPlugins<ThrowOnError extends boolean = false>(options?: Options<GetPluginsData, ThrowOnError>) {
        return (options?.client ?? this.client).get<GetPluginsResponses, unknown, ThrowOnError>({ url: '/plugins', ...options });
    }
    
    /**
     * Event stream (SSE)
     *
     * Subscribe to server-sent events for real-time updates. Filter by sessionId or flowId.
     */
    public getEvent<ThrowOnError extends boolean = false>(options?: Options<GetEventData, ThrowOnError>) {
        return (options?.client ?? this.client).sse.get<GetEventResponses, unknown, ThrowOnError>({ url: '/event', ...options });
    }
}
